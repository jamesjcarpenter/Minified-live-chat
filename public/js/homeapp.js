window.addEventListener("load",()=>{$("#start").click(),$("#start").hide(),$("#bitrateset").hide(),$("#start2").click(),$("#start2").hide();var e=window.location.href;console.log(e),console.log(e.substr(e.lastIndexOf("/")+1)),$("#copyinput").val($("#copyinput").val()+""+window.location.href),$("#data").focus(),$(".input-group-addon").remove(),$("#youtubeopen").click(function(){$(".ui.longer.modal").modal("show")}),$(".ytp-cued-thumbnail-overlay-image").hide(),$(document).ready(function(){$(".arrow-right").bind("click",function(e){e.preventDefault(),$(".vid-list-container").stop().animate({scrollLeft:"+=336"},750)}),$(".arrow-left").bind("click",function(e){e.preventDefault(),$(".vid-list-container").stop().animate({scrollLeft:"-=336"},750)})});var a=JSON.stringify(new Date(Date.now()).toLocaleTimeString()),t=io.connect("anomic.io/");t.on("connect",function(){var a=e.substr(e.lastIndexOf("/")+1);t.room=a,t.emit("join",a),t.on("askForUserId",()=>{t.emit(t.id)}),$("#submitroom").click(function(){window.location="https://anomic.io/room/"+$("#urlname").val(),t.emit("admin",t.id)}),t.on("private-message",(e,a)=>{console.log("You received a message"),console.log(a.data)})}),t.on("updateusers",function(e){$("#userlist").empty(),$.each(e,function(a,n){$("#userlist").append('<a class="ui black circular image label"id="imagelabel"><img src="/images/avatarsmall.jpg"><span class="ui white text">'+a+"</span></a><br>");var i=$(".autoscroller");$(".autoscroller").bind("scroll mousedown wheel DOMMouseScroll mousewheel keyup",function(e){"DOMMouseScroll"===e.type||"keyup"===e.type||e.type,(e.originalEvent.detail<0||e.originalEvent.wheelDelta&&e.originalEvent.wheelDelta>0)&&clearInterval(o),(e.originalEvent.detail>0||e.originalEvent.wheelDelta&&e.originalEvent.wheelDelta<0)&&clearInterval(o)});var o=setInterval(function(){var e=i.scrollTop();i.scrollTop()+i.innerHeight()>=i[0].scrollHeight&&clearInterval(o),i.scrollTop(e+1)},50);console.log($(".ui.mini.button.pm").attr("name")),$(".ui.mini.button.pm").click(function(){$(".ui.mini.button.pm").each(function(){var a;a=$(".ui.mini.button.pm").attr("name"),console.log(a),t.emit("private-message",e,message,a)})}),t.on("msgStart",function(){console.log(userToPM)})})}),t.on("updatechat",function(e,t){$("#conversation").append('<div class="ui container"><div class="ui medium basic segment"></div></div>'),$("#scrollable").animate({scrollTop:$("#scrollable").prop("scrollHeight")},300),$("#data").focus(),$("#conversation").append($('<img id="useravatar" class="ui avatar image" src="/images/avatarsmall.jpg"></img><tag id="username"name="avatar"><span class="ui small text"><samp></samp></span></tag>').text(e)),$("#conversation").append($('<span class="ui small text" id="date"name="date"></span>').text(JSON.parse(a))),$("#conversation").append($('<div class="ui left pointing label"id="message"name="data"><div id="messagedata"><p class="messaging"><span class="ui small text"></span></p></div></div>').text(t)),$(".ui.left.pointing.label").each(function(){$(this).html($(this).html().replace(/((http|https|ftp):\/\/[\w?=&.\/-;#~%-]+(?![\w\s?&.\/;#~%"=-]*>))/g,'<a href="$1">$1</a> '))})}),t.on("serverupdatechat",function(e,a,t){$("#conversation").append('<div class="ui container"><div class="ui small basic segment"></div></div>'),$("#scrollable").animate({scrollTop:$("#scrollable").prop("scrollHeight")},1100),$("#conversation").append($('<div class="ui small grey label"id="servermessage"><span class="ui small text"></span></div>').text(e)),$("#roomname").empty()}),t.on("connect",function(e){$("#datasend").click(function(){var e=$("#data").val().trim();$("#data").val("");var a={"<3":"❤️","</3":"💔",":D":"😂",":)":"😀",";)":"😉",":(":"☹️",":p":"😋",";p":"😜",":'(":"😢","8)":"😎"};function n(e){return e.replace(/([()[{*+.$^\\|?])/g,"\\$1")}document.getElementById("data").oninput=function(){for(var e in a){var t=new RegExp(n(e),"gim");this.value=this.value=this.value.replace(t,a[e])}},t.emit("sendchat",e)}),$("#data").keypress(function(e){13==e.which&&($(this).blur(),$("#datasend").focus().click())})}),t.on("updateroomusers",function(e,a){$("#roomusers").empty(),$.each(e,function(e,a){$("#roomusers").append("+value+")})}),$("#data").keyup(function(){$("#data").val()?($("#datasend").show(),t.emit("typing")):$("#datasend").hide()}),t.on("typing",function(e){var a;clearTimeout(a),$("#typing").append('<div class="ui text container"><span class="ui small text" id="typing"></span></div>').text(e),a=setTimeout(function(){$("#typing").empty()},3500)}),t.on("roomcount",function(e){$("#rmcount").empty(),$("#rmcount").append(""+e.length)}),t.on("updateactive",function(e){$("#globallist").empty()}),t.on("updatehomepage",function(e,a){$("#goa").empty(),$.each(e,function(e,a,t){$("#goa").append('<div class="five wide column"><a href="/room/'+a+'"><div class="ui segment"id="rightlabelroom"><h3>'+a+'</h3><p id="desc">'+roomDesc+'</p></div></div></a><div class="ui basic segment"id="seg"></div>'),console.log(a.substr(a.lastIndexOf("/")+1))})}),t.on("disconnect",function(){t.emit("updateusers",t.usernames),t.broadcast.emit("serverupdatechat",t.username+" has disconnected"),t.leave(t.room),delete t.usernames[t.username]}),window.onunload=function(){$("#start").show(),$("#start").click()}});